---
---
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Logging out...</title>
  </head>
  <body>
    <script>
      import { getAuthService } from '../utils/AuthService';

      async function handleLogoutCallback() {
        try {
          const authService = getAuthService();
          await authService.handleLogoutCallback();
        } catch (error) {
          console.error('Logout callback warning:', error);
        }

        const isDesktopLogout = sessionStorage.getItem('is_desktop_logout') === 'true';
        sessionStorage.removeItem('is_desktop_logout');

        if (isDesktopLogout) {
            // Redirect back to Electron to clear its state
            window.location.href = 'sonacove://logout-callback';
            
            // Show feedback in browser
            document.body.innerHTML = "<h1>Logged out successfully.<br>You can close this tab.</h1>";
            return;
        }

        const returnUrl = sessionStorage.getItem('logout_return_url') || '/dashboard';
        sessionStorage.removeItem('logout_return_url');

        window.location.href = returnUrl;
      }

      handleLogoutCallback();
    </script>
  </body>
</html>
